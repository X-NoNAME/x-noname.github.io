<!DOCTYPE html>
<!--
Kazakov Ivan
mail@x-noname.ru
-->
<html>
    <head>
        <title>Фоторамка для планшета с поддержкой Motion photo и видео</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="img/stat.png">
        <link rel="apple-touch-icon image_src" href="img/stat.pn">


        <script src="js/libs/jquery/jquery.min.js" type="text/javascript"></script>
        <script src="js/libs/jquery.finger/jquery.finger.min.js" type="text/javascript"></script>
        <script src="js/yad.js" type="text/javascript"></script>
        <script src="js/main.js" type="text/javascript"></script>
        
        <script>
            loadSettings();
            //0x0112 : "Orientation",
            var token = get_cookie("yat");
            $(function() {
              // Handler for .ready() called.
                $("#content").dblclick(performClick);
                if(token === null){
                    document.location = 'https://x-noname.github.io/pvf/autorize.html';
                }else {
                    go();
                    if(getSettings('crop')){
                        maximize();
                    }
                    if(getSettings('motion')){
                        disableMove();
                    }
                    if(getSettings('folder')){

                    }
                }



                //close popup1
                $('#popup1').on('click', function(event){
                    if( $(event.target).is('.cd-popup-close') || $(event.target).is('.cd-popup') || $(event.target).is('.but-close')) {
                        event.preventDefault();
                        $(this).removeClass('is-visible');
                        play();
                    }else if( $(event.target).is('.but-yes')){
                        event.preventDefault();
                        del();
                        $(this).removeClass('is-visible');
                    }
                });

                //close popup when clicking the esc keyboard button
                $(document).keyup(function(event){
                    if(event.which=='27' && $('#popup1').hasClass('is-visible')){
                        $('#popup1').removeClass('is-visible');
                        play();
                    }
                });

                //close popup1
                $('#popup2').on('click', function(event){
                    if( $(event.target).is('.cd-popup-close') || $(event.target).is('.cd-popup') || $(event.target).is('.but-close')) {
                        event.preventDefault();
                        $(this).removeClass('is-visible');

                    }else if( $(event.target).is('.but-yes')){
                        event.preventDefault();
                        setFolder($('#selectfolders').val());
                        $(this).removeClass('is-visible');
                    }
                });

                //close popup when clicking the esc keyboard button
                $(document).keyup(function(event){
                    if(event.which=='27' && $('#popup2').hasClass('is-visible')){
                        $('#popup2').removeClass('is-visible');

                    }
                });

            });
            
        </script>
        <style>
            html, body {padding: 0;margin: 0;width:100%;height:100%;display: block; background-color: black}
            div#content {width:100%; max-height: 100%;height: 100%; display: block;}
            img.photo {width:100%; min-height: 100%;height: 100%;}
            li>img {
                max-width:100%;
                max-height:100%;
            }
            video {width:100%; min-height: 100%;height: 100%;}
            div.img {
              max-width:100%;
              max-height:100%;
              height:100%;
              display: block;
              background-repeat:no-repeat;

              background-position: center;
              
            }
            div#menu { display: block; position: absolute; right: 20px; bottom: 20px; color:silver; font-size: 48px; cursor:pointer}
            div#menuitems {    
                display: block;
                position: absolute;
                right: 20px;
                top: 40px;
                color: silver;
                padding: 5px;
            }
            ul {
                margin: 0;
                padding: 0;
            }
            li {
                margin: 0;
                padding: 0;
                display: block;
                cursor: pointer;
                width: 64px;
            }
            input[type="button"] {
                font-size: 48px;
            }
            
            div.date {
                display:block;
                position: absolute;
                bottom: 0;
                width: 10%;
                text-align: center;
                right: 45%;
                font-size: 1em;
                color:white;
                margin-left: -2%;
            }     
            
            @media all and (max-height: 400px) { 
                li, #menu>img { width: 32px; }
                div#confirm { font-size: 18px; right: 70px; padding: 5px;}
                input[type="button"] {font-size: 18px;}
            }
            @media all and (max-width: 400px) { 
                li, #menu>img { width: 32px; }
                div#confirm { font-size: 18px; right: 70px;  padding: 5px}
                input[type="button"] {font-size: 18px;}
                    
            }
            .controls {
                filter: invert(50%);
            }
            .controls:hover {
                filter: invert(100%);
            }
            .opened {
                filter: invert(100%);
            }
            #folders {
                display: none;
                background-color: beige;
                position: absolute;
                width: 50%;
                height: 50%;
                left:19%;
                top:19%;
                padding: 3%;
                text-align: center;
                font-size: 1.5em;
                min-height: 240px;
            }
            #confirm {
                  display: none;
                  background-color: beige;
                  position: absolute;
                  width: 40%;
                  height: 40%;
                  left:27%;
                  top:27%;
                  padding: 3%;
                  text-align: center;
                  font-size: 1.5em;
              }
            .disabled {
                filter: invert(20%);
            }





        </style>
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="confirm.css">

    </head>
    <body>

        <div id="content"></div>
        <div id="menu" onclick="showMenuContent();"><img class="controls params" src="img/params.png" alt="Settings"/></div>
        <div id="menuitems" style="display:none">
            <ul>
                <li onclick="stop();$('#popup1').addClass('is-visible');"><img class="controls delete" src="img/trashcan.png" alt="delete"/></li>
                <li id="plpa" onclick="playPause()"><img class="controls stop" src="img/pause.png" alt="Stop"/></li>
                <li id="next" onclick="stop();play();"><img class="controls next" src="img/next.png" alt="Next photo"/></li>
                <li id="folder" onclick="changeFolder();$('#popup2').addClass('is-visible');"><img class="controls folder" src="img/folder.png"/></li>
                <li id="imgstyle" onclick="maximize()"><img class="controls expand" src="img/expand.png" alt="Crop"/></li>
                <li id="movie" onclick="disableMove();"><img class="controls" src="img/stat.png" alt="Vertical crop"/></li>
            </ul>
        </div>
        <!--<div id="confirm" style="display:none"><img id="delprev" src="" alt="Preview"/><br/>Удалить фото?
            <input type="button" value="Да" onclick="$('#confirm').hide();del()"/>
            <input type="button" value="Отмена" onclick="play();$('#confirm').hide();"/>
        </div>-->
        <!--<div id="folders" style="display: none">
            <p>Из-за ограничений REST API Яндекса будут отображаться только те файлы, которые находятся в корне папки. Или подготовьте специальную папку с фотограффиями, или используйте папку автозагрузки фотограффий с телефона (Используется по умолчанию)</p>
            <select id="selectfolders" onchange="setFolder(this.value);">
                <option value="-1">Выбрать папку</option>
            </select>
        </div>-->
        <div id="invisible" style="display:none">
            <img id="imgcache" src="" alt="none"/>
        </div>
        <div id="popup1" class="cd-popup" role="alert" >
            <div class="cd-popup-container">
                <p id="title">Вы точно хотите удалить файл?</p>
                <img id="delprev" src="" alt="Preview"/>
                <ul class="cd-buttons">
                    <li><a href="#0" class="but-yes">Да</a></li>
                    <li><a href="#0" class="but-close">Нет</a></li>
                </ul>
                <a href="#0" class="cd-popup-close img-replace"> </a>
            </div> <!-- cd-popup-container -->
        </div> <!-- cd-popup -->
        <div id="popup2" class="cd-popup" role="alert" >
            <div class="cd-popup-container">
                <p>Выбор папки</p>
                <small>Из-за ограничений REST API Яндекса будут отображаться только те файлы, которые находятся в корне папки. Или подготовьте специальную папку с фотограффиями, или используйте папку автозагрузки фотограффий с телефона (Используется по умолчанию)</small>
                <br/>
                <select id="selectfolders">
                    <option value="-1">Выбрать папку</option>
                </select>

                <ul class="cd-buttons">
                    <li><a href="#0" class="but-yes">Да</a></li>
                    <li><a href="#0" class="but-close">Нет</a></li>
                </ul>
                <a href="#0" class="cd-popup-close img-replace"> </a>
            </div> <!-- cd-popup-container -->
        </div>

    </body>
</html>
